module Statistics.Distribution.Laplace

import Data.Floats

||| Returns the sign of the given number.
signum : Double -> Double
signum x = case compare x 0 of
                LT => -1
                EQ =>  1 -- assume that zero is positive
                GT =>  1

||| Represents the PDF of a Laplace distribution
|||
||| @mu The center of the dist.
||| @b  The spread of the dist.
||| @x  x
pdf : (mu:Double) -> (b:Double) -> (x:Double) -> Double
pdf mu b x = (1/2/b)*exp(-(abs (x - mu))/b)

||| Represents the CDF of a Laplace distribution
||| N.B. This is the inverse of samplePure.
|||
||| @mu The center of the dist.
||| @b  The spread of the dist.
||| @p  p
cdf : (mu:Double) -> (b:Double) -> (p:Double) -> Double
cdf mu b p = 0.5 + 0.5 * signum (p - mu) * (1 - exp (- (abs (p - mu) / b)))

||| Produces a value from the Laplace distribution given
||| a random uniform variable in [0,1)
|||
||| @mu The center of the dist.
||| @b  The spread of the dist.
||| @u  A random variable drawn uniformly from [0,1.0)
samplePure : (mu:Double) -> (b:Double) -> (u:Double) -> Double
samplePure mu b u = let x = u - 0.5
                     in mu - b * signum x * log (1 - 2 * abs x)

||| A list of truly random numbers from RANDOM.ORG
trueRandoms : List Float
trueRandoms = 
  [ 0.39665594 , 0.84423073 , 0.72371763 , 0.36065058 , 0.36237377 , 0.91667363 , 0.84519205
  , 0.54365474 , 0.79676163 , 0.09447574 , 0.67130767 , 0.82422684 , 0.51778720 , 0.59740637
  , 0.92968912 , 0.80625628 , 0.97921209 , 0.60354376 , 0.95518650 , 0.74054297 , 0.99699867
  , 0.42255635 , 0.91321578 , 0.25373719 , 0.76003038 , 0.61579629 , 0.05403706 , 0.28145826
  , 0.59468692 , 0.07098994 , 0.75520579 , 0.13351045 , 0.23667359 , 0.37079098 , 0.70817829
  , 0.14389409 , 0.79069841 , 0.45053227 , 0.44301796 , 0.73765896 , 0.34175720 , 0.69586080
  , 0.54650297 , 0.69981090 , 0.88614535 , 0.62604430 , 0.09187435 , 0.62233444 , 0.98179966
  , 0.57763600 , 0.16212894 , 0.49473479 , 0.78341829 , 0.73678025 , 0.77202705 , 0.73865220
  , 0.68524072 , 0.03106339 , 0.80123889 , 0.37040101 , 0.46498035 , 0.46156976 , 0.35120680
  , 0.40065933 , 0.42868577 , 0.45265628 , 0.12634450 , 0.38232078 , 0.21690644 , 0.12327168
  , 0.53159801 , 0.12232896 , 0.67462895 , 0.94111063 , 0.94614720 , 0.45950455 , 0.03817357
  , 0.10275251 , 0.83772666 , 0.68657559 , 0.63989768 , 0.91721514 , 0.09848206 , 0.57293655
  , 0.60856507 , 0.14970661 , 0.12367703 , 0.15074227 , 0.99134589 , 0.97883835 , 0.89861705
  , 0.59063844 , 0.85513868 , 0.63544856 , 0.82364311 , 0.78491182 , 0.22654547 , 0.90722856
  , 0.63494547 , 0.17238734 , 0.89012911 , 0.66378365 , 0.05450147 , 0.29584278 , 0.64221829
  , 0.22258150 , 0.43676380 , 0.72680130 , 0.08485143 , 0.71612584 , 0.33318040 , 0.58318757
  , 0.42821186 , 0.14421519 , 0.34152565 , 0.57489408 , 0.89744330 , 0.44806085 , 0.61135513
  , 0.67372711 , 0.60674422 , 0.24368641 , 0.04689972 , 0.93764405 , 0.44034170 , 0.70322968
  , 0.34986642 , 0.32762146 , 0.50378691 , 0.64205455 , 0.10514081 , 0.37474847 , 0.83421005
  , 0.12660973 , 0.56074120 , 0.33228390 , 0.04787097 , 0.16506296 , 0.25883173 , 0.90187307
  , 0.19919383 , 0.56931824 , 0.46778091 , 0.46036918 , 0.95494734 , 0.10535964 , 0.62681339
  , 0.85544164 , 0.80572956 , 0.95970057 , 0.62551358 , 0.53029203 , 0.00416522 , 0.12909956
  , 0.49006883 , 0.17692675 , 0.53521585 , 0.39745682 , 0.75321657 , 0.85102255 , 0.34746851
  , 0.15645780 , 0.69377650 , 0.47758394 , 0.06020596 , 0.10585769 , 0.37037950 , 0.45506035
  , 0.14130387 , 0.02586071 , 0.49700734 , 0.37495652 , 0.38471849 , 0.73114732 , 0.91480016
  , 0.27882836 , 0.43179047 , 0.53852737 , 0.48297070 , 0.32763171 , 0.15860384 , 0.94266020
  , 0.94225663 , 0.31040992 , 0.83891571 , 0.41028281 , 0.45853322 , 0.16808595 , 0.02087949
  , 0.52291855 , 0.30123594 , 0.75485707 , 0.71419562 , 0.86677932 , 0.12616656 , 0.68253911
  , 0.51009831 , 0.48822127 , 0.59925609 , 0.81100971 , 0.17827800 , 0.48254145 , 0.09832903
  , 0.99641776 , 0.36150916 , 0.38882908 , 0.06335849 , 0.24505263 , 0.49777120 , 0.47582739
  , 0.39115459 , 0.46905138 , 0.21176108 , 0.45228480 , 0.94266696 , 0.81726640 , 0.72373716
  , 0.59352477 , 0.00161284 , 0.84934279 , 0.76628177 , 0.12486382 , 0.01216740 , 0.74406034
  , 0.75207086 , 0.49727478 , 0.79179892 , 0.04115387 , 0.38403328 , 0.41220376 , 0.97843589
  , 0.97860399 , 0.47402634 , 0.30731047 , 0.75147923 , 0.56091203 , 0.67951992 , 0.78669360
  , 0.38227178 , 0.85870353 , 0.71346349 , 0.63789126 , 0.39750277 , 0.54849790 , 0.77628440
  , 0.57816939 , 0.07985845 , 0.50249685 , 0.38338188 , 0.76807782 , 0.42064066 , 0.93208176
  , 0.84046797 , 0.74522745 , 0.49519056 , 0.25096794 , 0.19214558 , 0.17003303 , 0.01541432
  , 0.16102139 , 0.50082796 , 0.07307386 , 0.68209124 , 0.11597029 , 0.88144839 , 0.27908247
  , 0.04248681 , 0.29989568 , 0.83106598 , 0.20923768 , 0.36171031 , 0.02571228 , 0.75890778
  , 0.96331639 , 0.75223617 , 0.57774430 , 0.85866498 , 0.71060105 , 0.07733344 , 0.06238275
  , 0.09240375 , 0.83779189 , 0.41382228 , 0.46875502 , 0.82062551 , 0.27799518 , 0.69775005
  , 0.52072397 , 0.61409681 , 0.18972891 , 0.29655182 , 0.60715482 , 0.88032938 , 0.60115470
  , 0.36502444 , 0.29924770 , 0.95823648 , 0.97556953 , 0.07178344 , 0.10095634 , 0.77125390
  , 0.85135566 , 0.64105108 , 0.29600135 , 0.55020645 , 0.25279126 , 0.46929920 , 0.77343430
  , 0.43223041 , 0.97257404 , 0.91288087 , 0.83502859 , 0.20812204 , 0.92739181 , 0.17619592
  , 0.73513423 , 0.36006198 , 0.04777577 , 0.30375708 , 0.57224863 , 0.59833950 , 0.16621886
  , 0.89882474 , 0.86952521 , 0.57295030 , 0.17622857 , 0.67818766 , 0.64187539 , 0.17038475
  , 0.72431583 , 0.97048284 , 0.23132030 , 0.30478510 , 0.12043105 , 0.53386260 , 0.88415875
  , 0.75257025 , 0.97370400 , 0.44513526 , 0.45042746 , 0.05552833 , 0.17604269 , 0.51086356
  , 0.52674358 , 0.99494951 , 0.02846262 , 0.36444439 , 0.95427745 , 0.57830215 , 0.72258782
  , 0.53629154 , 0.64783541 , 0.43415767 , 0.08852024 , 0.77333819 , 0.03414477 , 0.18495130
  , 0.19746565 , 0.44311653 , 0.29360350 , 0.01407790 , 0.22474429 , 0.21895572 , 0.54076065
  , 0.36069408 , 0.89174379 , 0.23531370 , 0.94969640 , 0.74662149 , 0.16124704 , 0.28509425
  , 0.84472878 , 0.97943699 , 0.35529131 , 0.69916460 , 0.46543308 , 0.89703551 , 0.94182273
  , 0.64171032 , 0.19937947 , 0.11503219 , 0.70159504 , 0.88997667 , 0.79790143 , 0.68781283
  , 0.69664960 , 0.26929634 , 0.53502091 , 0.45080810 , 0.98432862 , 0.51230405 , 0.24368964
  , 0.85922515 , 0.88071231 , 0.14834252 , 0.91652282 , 0.67624874 , 0.86514255 , 0.99533961
  , 0.52338495 , 0.87511417 , 0.67914333 , 0.43438590 , 0.82841037 , 0.10655672 , 0.58841009
  , 0.61313805 , 0.82868579 , 0.40155462 , 0.76447673 , 0.21201091 , 0.95646436 , 0.86226463
  , 0.77689593 , 0.84545468 , 0.53348833 , 0.83426286 , 0.36328726 , 0.68835214 , 0.80053203
  , 0.03506790 , 0.37256168 , 0.13967163 , 0.51090670 , 0.65124874 , 0.85358580 , 0.12952913
  , 0.72330487 , 0.39426476 , 0.93931944 , 0.23041408 , 0.78139201 , 0.92286139 , 0.17645508
  , 0.41683414 , 0.06710484 , 0.64993451 , 0.70779509 , 0.88004647 , 0.55440736 , 0.98824989
  , 0.02262519 , 0.20028790 , 0.02052397 , 0.09561595 , 0.63728874 , 0.58495807 , 0.60746634
  , 0.25379476 , 0.97920359 , 0.56960307 , 0.24613754 , 0.74141113 , 0.49540497 , 0.81076270
  , 0.73573485 , 0.21704927 , 0.73880846 , 0.53589725 , 0.75878868 , 0.46265373 , 0.46954910
  , 0.23535691 , 0.34504940 , 0.99412129 , 0.07243703 , 0.96429645 , 0.57782436 , 0.72890509
  , 0.79495187 , 0.01556032 , 0.53559466 , 0.84614904 , 0.91928257 , 0.43562772 , 0.33346705
  , 0.22012474 , 0.13817267 , 0.33904782 , 0.80393252 , 0.36594587 , 0.95346698 , 0.00153075
  , 0.96694761 , 0.00554775 , 0.29450085 , 0.87697702 , 0.23698056 , 0.49651426 , 0.00231638
  , 0.89002287 , 0.06797627 , 0.35577592 , 0.69064837 , 0.54387595 , 0.28477095 , 0.81150470
  , 0.68492029 , 0.18847145 , 0.70962459 , 0.42482001 , 0.19753301 , 0.01083201 , 0.63164175
  , 0.30908149 , 0.66290074 , 0.82042165 , 0.60575986 , 0.49039753 , 0.15142870 , 0.06739210
  , 0.78891737 , 0.60690194 , 0.26610776 , 0.26941032 , 0.97817592 , 0.36756168 , 0.36661389
  , 0.13295921 , 0.13100128 , 0.84221489 , 0.95264197 , 0.57935520 , 0.58556696 , 0.57879936
  , 0.54513231 , 0.49953654 , 0.40191323 , 0.64751656 , 0.34014215 , 0.07620370 , 0.74946583
  , 0.44736316 , 0.02762035 , 0.53672716 , 0.04926218 , 0.18949589 , 0.27584251 , 0.65982691
  , 0.54918199 , 0.65108908 , 0.66530948 , 0.97776642 , 0.44032863 , 0.87654285 , 0.89800469
  , 0.05510032 , 0.53165112 , 0.73704818 , 0.70404725 , 0.94159803 , 0.11056852 , 0.66368717
  , 0.60351546 , 0.83677316 , 0.26650507 , 0.41454974 , 0.03332566 , 0.11826172 , 0.65274977
  , 0.64550560 , 0.16576398 , 0.13981106 , 0.98856283 , 0.87805099 , 0.15407567 , 0.86797887
  , 0.59865374 , 0.43357137 , 0.14741842 , 0.96483010 , 0.68973984 , 0.53815774 , 0.69931612
  , 0.56786101 , 0.05174727 , 0.19865380 , 0.58565818 , 0.39284793 , 0.97807090 , 0.41113676
  , 0.03983283 , 0.85868321 , 0.14467273 , 0.45887999 , 0.58928093 , 0.14824763 , 0.07615036
  , 0.10963606 , 0.25749236 , 0.99197744 , 0.31108938 , 0.74728893 , 0.73694405 , 0.42533769
  , 0.03410126 , 0.02777046 , 0.63600446 , 0.50559806 , 0.99259601 , 0.51217849 , 0.46558332
  , 0.94283412 , 0.29211649 , 0.47286536 , 0.44107229 , 0.19582689 , 0.10012955 , 0.99731685
  , 0.19088418 , 0.84995361 , 0.28906550 , 0.60653060 , 0.01890601 , 0.56070330 , 0.38033159
  , 0.58427864 , 0.27939312 , 0.78328333 , 0.84919048 , 0.84285809 , 0.66734817 , 0.85588364
  , 0.81795653 , 0.57226771 , 0.00984915 , 0.73786528 , 0.21445358 , 0.60980255 , 0.42193479
  , 0.07281772 , 0.53138437 , 0.26691021 , 0.48290755 , 0.87570741 , 0.95023643 , 0.61660370
  , 0.68301291 , 0.15899979 , 0.70798099 , 0.26452640 , 0.60955106 , 0.44549785 , 0.07640743
  , 0.81038790 , 0.38314096 , 0.26500119 , 0.91804525 , 0.88609341 , 0.98488467 , 0.69217766
  , 0.43933115 , 0.16506114 , 0.18220643 , 0.60164271 , 0.48656109 , 0.91627314 , 0.90693965
  , 0.31392816 , 0.40684906 , 0.10036004 , 0.28192358 , 0.08372817 , 0.55174281 , 0.48179518
  , 0.16087021 , 0.33857167 , 0.12720070 , 0.10838442 , 0.32491132 , 0.57234545 , 0.73981391
  , 0.56432083 , 0.55305565 , 0.59319083 , 0.28258753 , 0.49167075 , 0.29517119 , 0.85034216
  , 0.07034387 , 0.03531577 , 0.34442062 , 0.83669734 , 0.72626212 , 0.38857062 , 0.28885746
  , 0.33186252 , 0.07165360 , 0.88555905 , 0.34891304 , 0.27982559 , 0.51067014 , 0.09704114
  , 0.59852069 , 0.83560143 , 0.06946970 , 0.30060892 , 0.34622068 , 0.42658764 , 0.01854198
  , 0.99465084 , 0.02835338 , 0.01327092 , 0.95519934 , 0.42121864 , 0.91179599 , 0.34406243
  , 0.21070305 , 0.62777291 , 0.74061780 , 0.16796005 , 0.27854408 , 0.34997260 , 0.27602299
  , 0.76139878 , 0.68890354 , 0.60874753 , 0.79709245 , 0.33607907 , 0.41826621 , 0.89521005
  , 0.23000165 , 0.87298365 , 0.90111496 , 0.68314108 , 0.48748756 , 0.96605927 , 0.04576401
  , 0.68391730 , 0.58693380 , 0.26459118 , 0.76850892 , 0.07590297 , 0.33857795 , 0.56949639
  , 0.74637430 , 0.86470293 , 0.62993929 , 0.64599424 , 0.68558336 , 0.40724430 , 0.77883635
  , 0.11161214 , 0.65824771 , 0.63334533 , 0.74550831 , 0.66187631 , 0.29746634 , 0.23692450
  , 0.50525022 , 0.33573780 , 0.03961550 , 0.52646218 , 0.63506625 , 0.50465350 , 0.33992078
  , 0.13019817 , 0.40046261 , 0.13560507 , 0.49097511 , 0.63573307 , 0.47887456 , 0.58725838
  , 0.09963285 , 0.08196315 , 0.60470875 , 0.33297175 , 0.06546464 , 0.32100135 , 0.31306506
  , 0.85111530 , 0.98136547 , 0.14131681 , 0.32524039 , 0.80937726 , 0.11494662 , 0.46643094
  , 0.30047589 , 0.31020462 , 0.34051601 , 0.42113697 , 0.21588673 , 0.76231017 , 0.68207425
  , 0.07366696 , 0.72007461 , 0.29648682 , 0.61315742 , 0.15751766 , 0.56383186 , 0.60899696
  , 0.48594472 , 0.67258897 , 0.53367750 , 0.10504151 , 0.27097502 , 0.34373299 , 0.33487387
  , 0.45255181 , 0.97695766 , 0.40441979 , 0.15646686 , 0.79013216 , 0.47474814 , 0.74806594
  , 0.50320014 , 0.38619660 , 0.31741494 , 0.97289951 , 0.58516549 , 0.49342952 , 0.11065718
  , 0.98280784 , 0.39464369 , 0.20928705 , 0.74834149 , 0.53395580 , 0.71204257 , 0.70658322
  , 0.83338606 , 0.57823953 , 0.71451418 , 0.10700635 , 0.06786837 , 0.02801155 , 0.48902257
  , 0.68455028 , 0.44915445 , 0.50631323 , 0.48306828 , 0.44703575 , 0.13843240 , 0.02997498
  , 0.02861726 , 0.05802935 , 0.25888764 , 0.13111315 , 0.41200091 , 0.55141937 , 0.00220100
  , 0.08755750 , 0.21343128 , 0.08825580 , 0.45010549 , 0.55548489 , 0.43132647 , 0.04813274
  , 0.34262568 , 0.92833384 , 0.37691117 , 0.91030811 , 0.34771373 , 0.32163375 , 0.69074631
  , 0.75628631 , 0.92086633 , 0.66030521 , 0.64033467 , 0.19960719 , 0.06779854 , 0.47107573
  , 0.57550726 , 0.84294587 , 0.39059756 , 0.34989559 , 0.51079685 , 0.52071586 , 0.92783795
  , 0.24273356 , 0.83695680 , 0.83587864 , 0.90953552 , 0.87939408 , 0.03950851 , 0.54679915
  , 0.34326133 , 0.28415576 , 0.86884784 , 0.05518224 , 0.08315040 , 0.89043144 , 0.51778160
  , 0.73144967 , 0.79470992 , 0.84760174 , 0.51807825 , 0.51274095 , 0.82014784 , 0.03913908
  , 0.91888992 , 0.63362366 , 0.05241139 , 0.84579151 , 0.27405819 , 0.62879362 , 0.32661877
  , 0.03484559 , 0.86026459 , 0.47997767 , 0.60932173 , 0.28334593 , 0.71789396 , 0.67855899
  , 0.88861495 , 0.98452054 , 0.20679864 , 0.98906060 , 0.12240559 , 0.33436386 , 0.16937643
  , 0.02509428 , 0.66271614 , 0.76091034 , 0.43524825 , 0.02142083 , 0.99801141 , 0.68297120
  , 0.70096587 , 0.66823981 , 0.69294287 , 0.57620418 , 0.67265982 , 0.67962937 , 0.39812282
  , 0.25011449 , 0.76228495 , 0.09211917 , 0.47054059 , 0.18455584 , 0.12416930 , 0.61602653
  , 0.67202119 , 0.72885399 , 0.12916713 , 0.87244544 , 0.90473533 , 0.58756147 , 0.42797846
  , 0.45124765 , 0.14059878 , 0.94936722 , 0.77653437 , 0.64503850 , 0.17418226 , 0.87752138
  , 0.33161631 , 0.00239636 , 0.63878149 , 0.20803870 , 0.98499369 , 0.76457420 , 0.78777503
  , 0.40183132 , 0.76373745 , 0.69360657 , 0.15358216 , 0.52939513 , 0.85212502 , 0.42108724
  , 0.50022074 , 0.95570271 , 0.72703414 , 0.80768611 , 0.42404787 , 0.55144298 , 0.71419834
  , 0.97319637 , 0.29764109 , 0.54024320 , 0.54277707 , 0.35334924 , 0.94330164 , 0.36523982
  , 0.98855728 , 0.64490098 , 0.27159517 , 0.15371532 , 0.64623045 , 0.65356039 , 0.44139672
  , 0.53887417 , 0.90889018 , 0.35451386 , 0.13082307 , 0.38671458 , 0.84297371 , 0.90435510
  , 0.00709267 , 0.30978560 , 0.59848295 , 0.00434957 , 0.30800658 , 0.62532822 , 0.52036703
  , 0.17273994 , 0.02388221 , 0.77334077 , 0.09235672 , 0.15415091 , 0.47625411 ]
  
